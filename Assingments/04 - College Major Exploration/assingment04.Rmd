---
title: "Assignment 04 - College Data Analysis"
author: "tony sulfaro"
date: "4/29/2019"
output: html_document
---

# Install Needed Dependencies
```{r setup}
library(fivethirtyeight)
library(tidyverse)
library(GGally)
```

# Data Background

The college data `college_all_ages` comes from the package `fivethrityeight` as a dataset included by defualt when installed. The data contained within the dataset originally came from an American Community Survey 2010-2012. The data was collected to help give insight into the compensation and unemployment rates. This data can help us answer questions about which majors have the higest and lowest compensation rates as well as how unemployment rates compare.

# Data Characteristics

There are `r nrow(college_all_ages)` entries in the `college_all_ages` dataset with `r ncol(college_all_ages)` variables. An observation in this dataset is a specific major and the attributes that go along with it (like number of people with that degree and median compensation).

```{r, include=FALSE}
# Variables in the Dataset

## major_code Major code, FO1DP in ACS PUMS

## major - Major description
## major_category - Category of major from Carnevale et al
## total - Total number of people with major
## employed - Number employed (ESR == 1 or 2)
## employed_fulltime_yearround - Employed at least 50 weeks (WKW == 1) and at least 35 hours (WKHP >= 35)
## unemployed - Number unemployed (ESR == 3)
## unemployment_rate - Unemployed / (Unemployed + Employed)
## p25th - 25th percentile of earnings
## median - Median earnings of full-time, year-round workers
## p75th - 75th percentile of earnings
```

# Variation within variables

Let's take a look at major categories and total compensation.

```{r, include=FALSE}
a = college_all_ages %>%
  group_by(major_category) %>%
  mutate(average_median_earnings = mean(median), st_dev_earnings = sd(median)) %>%
  select(major_category, average_median_earnings, st_dev_earnings) %>%
  arrange(desc(average_median_earnings))

ggplot(a, aes(x=reorder(major_category, -average_median_earnings), y=average_median_earnings)) + 
  geom_bar(stat = "identity",position="dodge") +
  theme(axis.text.x = element_text(angle = 90, hjust = 1))

ggplot(a, aes(x=reorder(major_category, -st_dev_earnings), y=st_dev_earnings)) + 
  geom_bar(stat = "identity",position="dodge") +
  theme(axis.text.x = element_text(angle = 90, hjust = 1))
```

```{r, echo=FALSE}
b = college_all_ages %>%
  group_by(major_category) %>%
  mutate(average_median_earnings = mean(median), median_earnings = median(median))
  
ggplot(b, aes(x=reorder(major_category,-average_median_earnings), y=median)) + 
  geom_boxplot() + coord_flip() +
  labs(x = "Major Category", 
    y="Annual Salary in USD", 
    title="Compensation by Major Category",
    caption="Major Categories Arranged by Average Median Salary, Outliers Indicated as Dots") +
  theme_minimal()
```

After generating a boxplot for each of the major categories we can see how much each of them vary as well as the range for the values. The Median pay for Engineering is the highest major category while Education is the lowest median compensation. However, because of how broad engineering is the values range from ~60k all the way up to 125k if you include outliers (~90k without).

# Covariation	Between	Variables

To help us identify trends between variables we can use `ggpairs()` to plot multiple variables against one another and obtain their r value. The r value is a number that ranges from -1.0 to 1.0 that indicates how linearly two variables correlate to one another, (-1 meaning complete negative correlation, 1 meaining complete positive correlation).

```{r}
college_all_ages %>%
  select(total, employed, employed_fulltime_yearround, unemployed, unemployment_rate, median) %>%
  ggpairs()
```

After looking through the various combinations of variable scatter plots I want to know a bit more about the correltion between average compensation and unemployment rate. Let's construct a scatterplot of these two variables and split it apart by Major Category once again.


```{r}
c = college_all_ages %>%
  group_by(major_category) %>%
  mutate(average_median_earnings = mean(median), unemployment_rate_percent = unemployment_rate * 100) %>%
  select(major_category, unemployment_rate_percent, average_median_earnings)
c
ggplot(c,mapping = aes(x=reorder(major_category,-average_median_earnings), y=average_median_earnings, fill=unemployment_rate_percent)) + 
  geom_bar(stat = "identity",position="dodge",) +
  coord_flip()+
  scale_fill_gradient2(low = "blue", mid = "white", high = "red") +
  labs(x = "Major Category", 
    y="Annual Salary in USD", 
    title="Compensation by Major Category",
    caption="Major Categories Arranged by Average Median Salary",
    fill = "Unemployment Rate") +
  theme_minimal()
```
